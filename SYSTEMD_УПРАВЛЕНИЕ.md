# üöÄ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–æ—Ç–æ–º —á–µ—Ä–µ–∑ systemd

> –ë–æ—Ç –∑–∞–ø—É—â–µ–Ω –∫–∞–∫ —Å–∏—Å—Ç–µ–º–Ω—ã–π —Å–µ—Ä–≤–∏—Å –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ —Ñ–æ–Ω–æ–≤–æ–º —Ä–µ–∂–∏–º–µ

---

## ‚úÖ –ë–æ—Ç —É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –∏ –∑–∞–ø—É—â–µ–Ω!

–°–µ—Ä–≤–∏—Å: **`metrotech-bot`**  
–°—Ç–∞—Ç—É—Å: üü¢ **–†–∞–±–æ—Ç–∞–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏**  
–ê–≤—Ç–æ–∑–∞–ø—É—Å–∫: ‚úÖ **–í–∫–ª—é—á–µ–Ω** (–∑–∞–ø—É—Å—Ç–∏—Ç—Å—è –ø–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ —Å–µ—Ä–≤–µ—Ä–∞)

---

## üìã –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å –±–æ—Ç–∞:**
```bash
sudo systemctl status metrotech-bot
```

### **–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞ (–ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π –∫–æ–¥–∞/–∫–æ–Ω—Ñ–∏–≥–∞):**
```bash
sudo systemctl restart metrotech-bot
```

### **–û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –±–æ—Ç–∞:**
```bash
sudo systemctl stop metrotech-bot
```

### **–ó–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞:**
```bash
sudo systemctl start metrotech-bot
```

### **–û—Ç–∫–ª—é—á–∏—Ç—å –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫ (–µ—Å–ª–∏ –Ω–µ –Ω—É–∂–µ–Ω):**
```bash
sudo systemctl disable metrotech-bot
```

### **–í–∫–ª—é—á–∏—Ç—å –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫ –æ–±—Ä–∞—Ç–Ω–æ:**
```bash
sudo systemctl enable metrotech-bot
```

---

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ª–æ–≥–∏

### **–ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–µ –ª–æ–≥–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏:**
```bash
sudo journalctl -u metrotech-bot -f
```

### **–ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–µ 50 —Å—Ç—Ä–æ–∫ –ª–æ–≥–æ–≤:**
```bash
sudo journalctl -u metrotech-bot -n 50
```

### **–õ–æ–≥–∏ –±–æ—Ç–∞ (–Ω–∞—à —Ñ–∞–π–ª):**
```bash
tail -f /root/Asterisk_bot/asterisk-vox-bot/bot.log
```

### **–ü–æ—Å–ª–µ–¥–Ω–∏–µ 100 —Å—Ç—Ä–æ–∫ –ª–æ–≥–∞:**
```bash
tail -n 100 /root/Asterisk_bot/asterisk-vox-bot/bot.log
```

### **–ü–æ–∏—Å–∫ –æ—à–∏–±–æ–∫ –≤ –ª–æ–≥–∞—Ö:**
```bash
tail -n 200 /root/Asterisk_bot/asterisk-vox-bot/bot.log | grep -E "(ERROR|‚ùå|CRITICAL)"
```

---

## üîÑ –¢–∏–ø–∏—á–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### **–°—Ü–µ–Ω–∞—Ä–∏–π 1: –ò–∑–º–µ–Ω–∏–ª–∏ –∫–æ–¥ –∏–ª–∏ .env**
```bash
# 1. –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –±–æ—Ç–∞
sudo systemctl stop metrotech-bot

# 2. –°–¥–µ–ª–∞—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å .env)
nano /root/Asterisk_bot/asterisk-vox-bot/.env

# 3. –ó–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞
sudo systemctl start metrotech-bot

# 4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç
sudo systemctl status metrotech-bot
```

**–ò–ª–∏ –∫–æ—Ä–æ—á–µ (–æ–¥–Ω–æ–π –∫–æ–º–∞–Ω–¥–æ–π):**
```bash
sudo systemctl restart metrotech-bot && sudo systemctl status metrotech-bot
```

---

### **–°—Ü–µ–Ω–∞—Ä–∏–π 2: –ë–æ—Ç —É–ø–∞–ª (–ø—Ä–æ–≤–µ—Ä–∫–∞ –∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫)**
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å
sudo systemctl status metrotech-bot

# –ï—Å–ª–∏ "failed" - –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏
sudo journalctl -u metrotech-bot -n 50

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å
sudo systemctl restart metrotech-bot
```

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –ë–æ—Ç –Ω–∞—Å—Ç—Ä–æ–µ–Ω –Ω–∞ **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫** (Restart=always), –ø–æ—ç—Ç–æ–º—É –¥–∞–∂–µ –µ—Å–ª–∏ —É–ø–∞–¥—ë—Ç - –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è —Å–∞–º —á–µ—Ä–µ–∑ 10 —Å–µ–∫—É–Ω–¥.

---

### **–°—Ü–µ–Ω–∞—Ä–∏–π 3: –û–±–Ω–æ–≤–∏–ª–∏ –∫–æ–¥ –∏–∑ Git**
```bash
# 1. –ü–µ—Ä–µ–π—Ç–∏ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –ø—Ä–æ–µ–∫—Ç–∞
cd /root/Asterisk_bot

# 2. –ü–æ–ª—É—á–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è
git pull

# 3. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞
sudo systemctl restart metrotech-bot

# 4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏
tail -f /root/Asterisk_bot/asterisk-vox-bot/bot.log
```

---

### **–°—Ü–µ–Ω–∞—Ä–∏–π 4: –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞**
```bash
# –ü—Ä–æ—Å—Ç–æ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ - –±–æ—Ç –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏!
sudo reboot

# –ü–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:
sudo systemctl status metrotech-bot
```

---

## üõ†Ô∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–µ—Ä–≤–∏—Å–∞

**–§–∞–π–ª —Å–µ—Ä–≤–∏—Å–∞:** `/etc/systemd/system/metrotech-bot.service`

### –ß—Ç–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ:

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ó–Ω–∞—á–µ–Ω–∏–µ | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|----------|----------|
| **Type** | simple | –ü—Ä–æ—Å—Ç–æ–π —Å–µ—Ä–≤–∏—Å |
| **User** | root | –ó–∞–ø—É—Å–∫ –æ—Ç root |
| **WorkingDirectory** | `/root/Asterisk_bot/asterisk-vox-bot` | –†–∞–±–æ—á–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è |
| **ExecStart** | `venv/bin/python app/backend/asterisk/stasis_handler_optimized.py` | –ö–æ–º–∞–Ω–¥–∞ –∑–∞–ø—É—Å–∫–∞ |
| **Restart** | always | –ê–≤—Ç–æ–ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏ |
| **RestartSec** | 10 | –ü–∞—É–∑–∞ –ø–µ—Ä–µ–¥ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–æ–º (10 —Å–µ–∫) |
| **StandardOutput** | `bot.log` | –õ–æ–≥–∏ stdout |
| **StandardError** | `bot.log` | –õ–æ–≥–∏ stderr |
| **After** | asterisk.service | –ó–∞–ø—É—Å–∫ –ü–û–°–õ–ï Asterisk |
| **Wants** | asterisk.service | –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç Asterisk |

---

## üìù –ï—Å–ª–∏ –Ω—É–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é —Å–µ—Ä–≤–∏—Å–∞

```bash
# 1. –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Ñ–∞–π–ª
sudo nano /etc/systemd/system/metrotech-bot.service

# 2. –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é systemd
sudo systemctl daemon-reload

# 3. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–∏—Å
sudo systemctl restart metrotech-bot
```

---

## üö® –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### **–ü—Ä–æ–±–ª–µ–º–∞: –°–µ—Ä–≤–∏—Å –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è**

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–µ—Ç–∞–ª—å–Ω—ã–π —Å—Ç–∞—Ç—É—Å
sudo systemctl status metrotech-bot -l

# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏
sudo journalctl -u metrotech-bot -n 100

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ venv —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
ls -la /root/Asterisk_bot/asterisk-vox-bot/venv/bin/python

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞ –≤—Ä—É—á–Ω—É—é –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
cd /root/Asterisk_bot/asterisk-vox-bot
source venv/bin/activate
python app/backend/asterisk/stasis_handler_optimized.py
```

---

### **–ü—Ä–æ–±–ª–µ–º–∞: –ë–æ—Ç –ø–æ—Å—Ç–æ—è–Ω–Ω–æ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è (loop)**

```bash
# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∏
sudo journalctl -u metrotech-bot | grep "Started\|stopped"

# –í—Ä–µ–º–µ–Ω–Ω–æ –æ—Ç–∫–ª—é—á–∏—Ç—å –∞–≤—Ç–æ–ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
sudo systemctl stop metrotech-bot
# ... –∑–∞–ø—É—Å—Ç–∏—Ç—å –≤—Ä—É—á–Ω—É—é –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏ ...
```

---

### **–ü—Ä–æ–±–ª–µ–º–∞: –õ–æ–≥–∏ –Ω–µ –ø–∏—à—É—Ç—Å—è**

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–∞–≤–∞ –Ω–∞ —Ñ–∞–π–ª –ª–æ–≥–∞
ls -la /root/Asterisk_bot/asterisk-vox-bot/bot.log

# –°–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª –µ—Å–ª–∏ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
touch /root/Asterisk_bot/asterisk-vox-bot/bot.log
chmod 644 /root/Asterisk_bot/asterisk-vox-bot/bot.log
```

---

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —á—Ç–æ –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ

```bash
# 1. –°—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–∏—Å–∞ (–¥–æ–ª–∂–Ω–æ –±—ã—Ç—å "active (running)")
sudo systemctl status metrotech-bot

# 2. –ü—Ä–æ—Ü–µ—Å—Å –∑–∞–ø—É—â–µ–Ω
ps aux | grep stasis_handler_optimized

# 3. –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ Asterisk ARI
sudo asterisk -rx "stasis show apps"
# –î–æ–ª–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å: asterisk-bot

# 4. –ü–æ—Å–ª–µ–¥–Ω–∏–µ –ª–æ–≥–∏ –±–µ–∑ –æ—à–∏–±–æ–∫
tail -n 30 /root/Asterisk_bot/asterisk-vox-bot/bot.log | grep "‚úÖ"
```

---

## üéØ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ systemd

‚úÖ **–ê–≤—Ç–æ–∑–∞–ø—É—Å–∫** - –±–æ—Ç –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è –ø–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ —Å–µ—Ä–≤–µ—Ä–∞  
‚úÖ **–ê–≤—Ç–æ–ø–µ—Ä–µ–∑–∞–ø—É—Å–∫** - –µ—Å–ª–∏ –±–æ—Ç —É–ø–∞–¥—ë—Ç, –æ–Ω –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏  
‚úÖ **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** - –≤—Å–µ –ª–æ–≥–∏ —Å–æ–±–∏—Ä–∞—é—Ç—Å—è –≤ journald –∏ `bot.log`  
‚úÖ **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ sudo** - —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã `start/stop/restart`  
‚úÖ **–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏** - –±–æ—Ç –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è –ü–û–°–õ–ï Asterisk  
‚úÖ **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** - –ª–µ–≥–∫–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å —á–µ—Ä–µ–∑ `systemctl status`

---

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 08.10.2025  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ù–∞—Å—Ç—Ä–æ–µ–Ω–æ –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç  
**–ê–≤—Ç–æ—Ä:** Claude (Anthropic)

