# üíæ –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –¥–∏—Å–∫–æ–≤–æ–≥–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞

> üìÖ **–°–æ–∑–¥–∞–Ω–æ**: 15.10.2025  
> üéØ **–¶–µ–ª—å**: –ù–∞–π—Ç–∏ –±–æ–ª—å—à–∏–µ —Ñ–∞–π–ª—ã –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å —Ä–æ—Å—Ç –¥–∏—Å–∫–∞  
> ‚ö†Ô∏è **–ü—Ä–æ–±–ª–µ–º–∞**: –î–∏—Å–∫ –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è –≤ –ø–∞—Å—Å–∏–≤–Ω–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏

---

## üìä –¢–µ–∫—É—â–∞—è —Å–∏—Ç—É–∞—Ü–∏—è

### –ë—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞:
```bash
# –û–±—â–µ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –¥–∏—Å–∫–∞
df -h /

# –¢–æ–ø-10 —Å–∞–º—ã—Ö –±–æ–ª—å—à–∏—Ö –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π –≤ –ø—Ä–æ–µ–∫—Ç–µ
du -sh /root/Asterisk_bot/* | sort -hr | head -10

# –ù–∞–π—Ç–∏ –±–æ–ª—å—à–∏–µ —Ñ–∞–π–ª—ã (>100MB)
find /root/Asterisk_bot -type f -size +100M -exec ls -lh {} \;
```

---

## üö® –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –ü–†–û–ë–õ–ï–ú–ê: Asterisk –ª–æ–≥–∏!

### ‚ö†Ô∏è Asterisk `messages.log` —Ä–∞—Å—Ç–µ—Ç –û–ß–ï–ù–¨ –±—ã—Å—Ç—Ä–æ!

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –§–∞–π–ª `/var/log/asterisk/messages.log` –º–æ–∂–µ—Ç –≤—ã—Ä–∞—Å—Ç–∏ –¥–æ **–Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –≥–∏–≥–∞–±–∞–π—Ç**
- –†–∞—Å—Ç–µ—Ç –¥–∞–∂–µ –±–µ–∑ –∑–≤–æ–Ω–∫–æ–≤ (–∏–∑-–∑–∞ SIP-–∞—Ç–∞–∫ –∏ –ø—Ä–æ–≤–µ—Ä–æ–∫)
- –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é **–ù–ï–¢ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π —Ä–æ—Ç–∞—Ü–∏–∏**

**–ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å:**
```bash
ls -lh /var/log/asterisk/messages.log
```

**–¢–∏–ø–∏—á–Ω–∞—è —Å–∏—Ç—É–∞—Ü–∏—è:**
```
-rw-r--r-- 1 asterisk asterisk 4.6G Oct 15 09:12 /var/log/asterisk/messages.log
```

### üîß –†–µ—à–µ–Ω–∏–µ: –ù–∞—Å—Ç—Ä–æ–∏—Ç—å —Ä–æ—Ç–∞—Ü–∏—é Asterisk –ª–æ–≥–æ–≤

#### **1. –°–æ–∑–¥–∞—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é logrotate:**

```bash
sudo nano /etc/logrotate.d/asterisk
```

**–°–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞:**
```
/var/log/asterisk/messages.log {
    daily
    rotate 7
    missingok
    notifempty
    compress
    delaycompress
    sharedscripts
    postrotate
        /usr/sbin/asterisk -rx 'logger reload' > /dev/null 2>&1 || true
    endscript
    create 0640 asterisk asterisk
}

/var/log/asterisk/*.log {
    weekly
    rotate 4
    missingok
    notifempty
    compress
    delaycompress
    sharedscripts
    postrotate
        /usr/sbin/asterisk -rx 'logger reload' > /dev/null 2>&1 || true
    endscript
    create 0640 asterisk asterisk
}
```

#### **2. –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è —Ä–æ—Ç–∞—Ü–∏—è (—Å–µ–π—á–∞—Å):**

```bash
# –†–æ—Ç–∏—Ä–æ–≤–∞—Ç—å –ª–æ–≥–∏ Asterisk –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å
sudo logrotate -f /etc/logrotate.d/asterisk

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç
ls -lh /var/log/asterisk/
```

#### **3. –≠–∫—Å—Ç—Ä–µ–Ω–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ (–µ—Å–ª–∏ –¥–∏—Å–∫ –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω):**

‚ö†Ô∏è **–û–°–¢–û–†–û–ñ–ù–û! –£–¥–∞–ª—è–µ—Ç –ª–æ–≥–∏ –±–µ–∑–≤–æ–∑–≤—Ä–∞—Ç–Ω–æ!**

```bash
# –°–¥–µ–ª–∞—Ç—å backup (–Ω–∞ –≤—Å—è–∫–∏–π —Å–ª—É—á–∞–π)
sudo cp /var/log/asterisk/messages.log /tmp/asterisk_messages_backup.log

# –û—á–∏—Å—Ç–∏—Ç—å —Ñ–∞–π–ª (–ù–ï —É–¥–∞–ª—è—Ç—å!)
sudo truncate -s 0 /var/log/asterisk/messages.log

# –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å –ª–æ–≥–≥–µ—Ä Asterisk
sudo asterisk -rx 'logger reload'

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å
ls -lh /var/log/asterisk/messages.log
```

---

## üîÑ –ß—Ç–æ —Ç–∞–∫–æ–µ —Ä–æ—Ç–∞—Ü–∏—è –ª–æ–≥–æ–≤?

**–ü—Ä–æ—Å—Ç—ã–º–∏ —Å–ª–æ–≤–∞–º–∏:** –≠—Ç–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–∏—Å—Ç–µ–º–∞, –∫–æ—Ç–æ—Ä–∞—è **–ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤—ã–≤–∞–µ—Ç, —Å–∂–∏–º–∞–µ—Ç –∏ —É–¥–∞–ª—è–µ—Ç** —Å—Ç–∞—Ä—ã–µ –ª–æ–≥–∏, —á—Ç–æ–±—ã –æ–Ω–∏ –Ω–µ –∑–∞–ø–æ–ª–Ω—è–ª–∏ –≤–µ—Å—å –¥–∏—Å–∫.

### –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:

1. **–î–µ–Ω—å 1**: Asterisk –ø–∏—à–µ—Ç –≤ `messages.log` (—Ç–µ–∫—É—â–∏–π –ª–æ–≥)
2. **–î–µ–Ω—å 2** (00:00): 
   - `messages.log` ‚Üí `messages.log.1` (–≤—á–µ—Ä–∞—à–Ω–∏–π)
   - –°–æ–∑–¥–∞–µ—Ç—Å—è –Ω–æ–≤—ã–π –ø—É—Å—Ç–æ–π `messages.log`
3. **–î–µ–Ω—å 3** (00:00):
   - `messages.log` ‚Üí `messages.log.1`
   - `messages.log.1` ‚Üí `messages.log.2.gz` (—Å–∂–∏–º–∞–µ—Ç—Å—è)
4. **–î–µ–Ω—å 8** (00:00):
   - –°–∞–º—ã–π —Å—Ç–∞—Ä—ã–π –ª–æ–≥ (7 –¥–Ω–µ–π –Ω–∞–∑–∞–¥) **—É–¥–∞–ª—è–µ—Ç—Å—è**

**–ò—Ç–æ–≥–æ**: –£ –≤–∞—Å –≤—Å–µ–≥–¥–∞:
- 1 —Ç–µ–∫—É—â–∏–π –ª–æ–≥ (—Å–µ–≥–æ–¥–Ω—è)
- 1 –≤—á–µ—Ä–∞—à–Ω–∏–π (–Ω–µ—Å–∂–∞—Ç—ã–π, –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞)
- 5 —Å—Ç–∞—Ä—ã—Ö (—Å–∂–∞—Ç—ã—Ö `.gz`)
- **–•—Ä–∞–Ω–∏—Ç—Å—è 7 –¥–Ω–µ–π**, —Å—Ç–∞—Ä–æ–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–¥–∞–ª—è–µ—Ç—Å—è

### –í–∞—à–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:

**Asterisk** (`/etc/logrotate.d/asterisk`):
```
messages.log   ‚Üí –ï–∂–µ–¥–Ω–µ–≤–Ω–æ, 7 –¥–Ω–µ–π, —Å–∂–∞—Ç–∏–µ
queue_log      ‚Üí –ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ, 4 –Ω–µ–¥–µ–ª–∏, —Å–∂–∞—Ç–∏–µ
```

**Metrotech** (`/etc/logrotate.d/metrotech`):
```
bot.log, fastapi.log, app-detailed.log ‚Üí –ï–∂–µ–¥–Ω–µ–≤–Ω–æ, 7 –¥–Ω–µ–π, —Å–∂–∞—Ç–∏–µ
```

### –ó–∞–ø—É—Å–∫ —Ä–æ—Ç–∞—Ü–∏–∏:

**–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:**
- –ö–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 00:00 (–ø–æ–ª–Ω–æ—á—å) —á–µ—Ä–µ–∑ cron

**–í—Ä—É—á–Ω—É—é (–ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ):**
```bash
# –†–æ—Ç–∞—Ü–∏—è –≤—Å–µ—Ö –ª–æ–≥–æ–≤
sudo logrotate -f /etc/logrotate.conf

# –¢–æ–ª—å–∫–æ Asterisk
sudo logrotate -f /etc/logrotate.d/asterisk

# –¢–æ–ª—å–∫–æ Metrotech
sudo logrotate -f /etc/logrotate.d/metrotech
```

---

## üîç –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Å–∫—Ä–∏–ø—Ç –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

–°–æ–∑–¥–∞–Ω —Å–∫—Ä–∏–ø—Ç **`disk_check.sh`** –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞.

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:

```bash
# –ü–µ—Ä–µ–π—Ç–∏ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é
cd /root/Asterisk_bot/CHECK_DISK

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É
./disk_check.sh

# –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –∏—Å—Ç–æ—Ä–∏–∏
./disk_check.sh --save

# –°—Ä–∞–≤–Ω–∏—Ç—å —Å –ø—Ä–µ–¥—ã–¥—É—â–µ–π –ø—Ä–æ–≤–µ—Ä–∫–æ–π
./disk_check.sh --compare
```

### –ß—Ç–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–∫—Ä–∏–ø—Ç:

1. **–û–±—â–µ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –¥–∏—Å–∫–∞**
2. **–¢–æ–ø-10 —Å–∞–º—ã—Ö –±–æ–ª—å—à–∏—Ö –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π**
3. **–¢–æ–ø-10 —Å–∞–º—ã—Ö –±–æ–ª—å—à–∏—Ö —Ñ–∞–π–ª–æ–≤**
4. **–ë–æ–ª—å—à–∏–µ –ª–æ–≥–∏ (>50MB)**
5. **–†–æ—Å—Ç —Å –ø—Ä–µ–¥—ã–¥—É—â–µ–π –ø—Ä–æ–≤–µ—Ä–∫–∏** (–µ—Å–ª–∏ –µ—Å—Ç—å –∏—Å—Ç–æ—Ä–∏—è)
6. **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –æ—á–∏—Å—Ç–∫–µ**

---

## üìÅ –ß—Ç–æ –æ–±—ã—á–Ω–æ –∑–∞–Ω–∏–º–∞–µ—Ç –º–µ—Å—Ç–æ

### 1. **–õ–æ–≥–∏ Asterisk** (üî¥ –ì–õ–ê–í–ù–ê–Ø –ü–†–û–ë–õ–ï–ú–ê!)

| –§–∞–π–ª | –¢–∏–ø–∏—á–Ω—ã–π —Ä–∞–∑–º–µ—Ä | –ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å |
|------|----------------|-------------|
| `/var/log/asterisk/messages.log` | **100MB - 10GB!** | üî¥ –û—á–µ–Ω—å –≤—ã—Å–æ–∫–∞—è |
| `/var/log/asterisk/queue_log` | 1-10MB | üü° –°—Ä–µ–¥–Ω—è—è |

**–†–µ—à–µ–Ω–∏–µ:**
- –ù–∞—Å—Ç—Ä–æ–∏—Ç—å —Ä–æ—Ç–∞—Ü–∏—é (—Å–º. –≤—ã—à–µ)
- –ú–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å –µ–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ

### 2. **–ó–∞–ø–∏—Å–∏ –∑–≤–æ–Ω–∫–æ–≤**

| –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è | –¢–∏–ø–∏—á–Ω—ã–π —Ä–∞–∑–º–µ—Ä | –ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å |
|-----------|----------------|-------------|
| `/var/spool/asterisk/recording/` | 10-100MB | üü° –°—Ä–µ–¥–Ω—è—è |
| `/var/lib/asterisk/sounds/stream_*.wav` | 5-50MB | üü¢ –ù–∏–∑–∫–∞—è |

**–†–µ—à–µ–Ω–∏–µ:**
- –û—á–∏—â–∞—Ç—å —Å—Ç–∞—Ä—ã–µ –∑–∞–ø–∏—Å–∏ —Ä–∞–∑ –≤ –º–µ—Å—è—Ü
- –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–≤—Ç–æ—É–¥–∞–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ cron

### 3. **Backups –ø—Ä–æ–µ–∫—Ç–∞**

| –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è | –¢–∏–ø–∏—á–Ω—ã–π —Ä–∞–∑–º–µ—Ä | –ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å |
|-----------|----------------|-------------|
| `/root/Asterisk_bot/project_backup/` | 500MB - 1GB | üü° –°—Ä–µ–¥–Ω—è—è |
| `/root/Asterisk_bot/–ê–†–•–ò–í/` | 1-50MB | üü¢ –ù–∏–∑–∫–∞—è |

**–†–µ—à–µ–Ω–∏–µ:**
- –•—Ä–∞–Ω–∏—Ç—å —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 3 backup
- –°—Ç–∞—Ä—ã–µ –ø–µ—Ä–µ–º–µ—â–∞—Ç—å –Ω–∞ –≤–Ω–µ—à–Ω–µ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ

### 4. **ChromaDB (–≤–µ–∫—Ç–æ—Ä–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ)**

| –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è | –¢–∏–ø–∏—á–Ω—ã–π —Ä–∞–∑–º–µ—Ä | –ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å |
|-----------|----------------|-------------|
| `asterisk-vox-bot/data/chroma/` | 10-100MB | üü¢ –ù–∏–∑–∫–∞—è |

**–†–µ—à–µ–Ω–∏–µ:**
- –û–±—ã—á–Ω–æ –Ω–µ –ø—Ä–æ–±–ª–µ–º–∞
- –†–∞—Å—Ç–µ—Ç —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –Ω–æ–≤—ã—Ö –∑–Ω–∞–Ω–∏–π

### 5. **Python –∫–µ—à**

| –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è | –¢–∏–ø–∏—á–Ω—ã–π —Ä–∞–∑–º–µ—Ä | –ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å |
|-----------|----------------|-------------|
| `**/__pycache__/` | 5-20MB | üü¢ –ù–∏–∑–∫–∞—è |
| `venv/` | 200-500MB | üü¢ –ù–∏–∑–∫–∞—è (–Ω–µ —É–¥–∞–ª—è—Ç—å!) |

**–†–µ—à–µ–Ω–∏–µ:**
- –ú–æ–∂–Ω–æ –æ—á–∏—Å—Ç–∏—Ç—å `__pycache__` (–ø–µ—Ä–µ—Å–æ–∑–¥–∞—Å—Ç—Å—è)
- `venv/` –ù–ï —É–¥–∞–ª—è—Ç—å!

---

## üßπ –ö–æ–º–∞–Ω–¥—ã –æ—á–∏—Å—Ç–∫–∏

### –ë–µ–∑–æ–ø–∞—Å–Ω—ã–µ (–º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å):

```bash
# 1. –û—á–∏—Å—Ç–∏—Ç—å Python –∫–µ—à
find /root/Asterisk_bot -type d -name __pycache__ -exec rm -rf {} + 2>/dev/null

# 2. –û—á–∏—Å—Ç–∏—Ç—å —Å—Ç–∞—Ä—ã–µ –∑–∞–ø–∏—Å–∏ –∑–≤–æ–Ω–∫–æ–≤ (—Å—Ç–∞—Ä—à–µ 30 –¥–Ω–µ–π)
find /var/spool/asterisk/recording/ -name "*.wav" -mtime +30 -delete

# 3. –û—á–∏—Å—Ç–∏—Ç—å –≤—Ä–µ–º–µ–Ω–Ω—ã–µ TTS —Ñ–∞–π–ª—ã (—Å—Ç–∞—Ä—à–µ 7 –¥–Ω–µ–π)
find /var/lib/asterisk/sounds/ -name "stream_*.wav" -mtime +7 -delete

# 4. –û—á–∏—Å—Ç–∏—Ç—å —Å—Ç–∞—Ä—ã–µ –ª–æ–≥–∏ –ø—Ä–æ–µ–∫—Ç–∞ (–µ—Å–ª–∏ –µ—Å—Ç—å)
find /var/log/metrotech/archive/ -name "*.log.*" -mtime +30 -delete
```

### –û—Å—Ç–æ—Ä–æ–∂–Ω—ã–µ (—Ç—Ä–µ–±—É—é—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏):

```bash
# 5. –£–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ä—ã–µ backups (–æ—Å—Ç–∞–≤–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–µ 3)
cd /root/Asterisk_bot/project_backup/
ls -t | tail -n +4 | xargs rm -rf

# 6. –û—á–∏—Å—Ç–∏—Ç—å Redis dump (–µ—Å–ª–∏ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ)
# –í–ù–ò–ú–ê–ù–ò–ï: –£–¥–∞–ª–∏—Ç –∫–µ—à!
redis-cli FLUSHALL

# 7. –†–æ—Ç–∞—Ü–∏—è –ª–æ–≥–æ–≤ Asterisk
sudo logrotate -f /etc/logrotate.d/asterisk
```

### –û–ü–ê–°–ù–´–ï (–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –≤ –∫—Ä–∞–π–Ω–µ–º —Å–ª—É—á–∞–µ):

```bash
# ‚ö†Ô∏è –û—á–∏—Å—Ç–∫–∞ –≤—Å–µ—Ö –ª–æ–≥–æ–≤ Asterisk
sudo truncate -s 0 /var/log/asterisk/messages.log
sudo asterisk -rx 'logger reload'

# ‚ö†Ô∏è –£–¥–∞–ª–µ–Ω–∏–µ –≤—Å–µ—Ö –∑–∞–ø–∏—Å–µ–π –∑–≤–æ–Ω–∫–æ–≤
rm -rf /var/spool/asterisk/recording/*

# ‚ö†Ô∏è –£–¥–∞–ª–µ–Ω–∏–µ –≤—Å–µ—Ö TTS —Ñ–∞–π–ª–æ–≤
rm -rf /var/lib/asterisk/sounds/stream_*.wav
```

---

## üìä –†–µ–≥—É–ª—è—Ä–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –ï–∂–µ–¥–Ω–µ–≤–Ω–æ (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —á–µ—Ä–µ–∑ cron):

```bash
# –î–æ–±–∞–≤–∏—Ç—å –≤ crontab
crontab -e

# –ó–∞–ø—É—Å–∫–∞—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 3:00
0 3 * * * /root/Asterisk_bot/CHECK_DISK/disk_check.sh --save >> /var/log/disk_check.log 2>&1

# –û—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö –∑–∞–ø–∏—Å–µ–π –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 4:00
0 4 * * * find /var/spool/asterisk/recording/ -name "*.wav" -mtime +30 -delete

# –û—á–∏—Å—Ç–∫–∞ TTS —Ñ–∞–π–ª–æ–≤ –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 4:30
30 4 * * * find /var/lib/asterisk/sounds/ -name "stream_*.wav" -mtime +7 -delete
```

### –ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ (–≤—Ä—É—á–Ω—É—é):

```bash
# –ö–∞–∂–¥—ã–π –ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫ —É—Ç—Ä–æ–º
cd /root/Asterisk_bot/CHECK_DISK && ./disk_check.sh --compare

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–∑–º–µ—Ä Asterisk –ª–æ–≥–æ–≤
ls -lh /var/log/asterisk/messages.log

# –ï—Å–ª–∏ –±–æ–ª—å—à–µ 1GB - —Ä–æ—Ç–∏—Ä–æ–≤–∞—Ç—å
sudo logrotate -f /etc/logrotate.d/asterisk
```

### –ï–∂–µ–º–µ—Å—è—á–Ω–æ (–≤—Ä—É—á–Ω—É—é):

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å backups
du -sh /root/Asterisk_bot/project_backup/

# –£–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ä—ã–µ (–æ—Å—Ç–∞–≤–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–µ 3)
cd /root/Asterisk_bot/project_backup/
ls -t | tail -n +4 | xargs rm -rf
```

---

## üö® –ê–ª–µ—Ä—Ç—ã –∏ –ø–æ—Ä–æ–≥–∏

### –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —É—Ä–æ–≤–Ω–∏:

| –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –¥–∏—Å–∫–∞ | –°—Ç–∞—Ç—É—Å | –î–µ–π—Å—Ç–≤–∏–µ |
|---------------------|--------|----------|
| < 70% | üü¢ OK | –ù–∏—á–µ–≥–æ –Ω–µ –¥–µ–ª–∞—Ç—å |
| 70-85% | üü° –í–Ω–∏–º–∞–Ω–∏–µ | –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –±–æ–ª—å—à–∏–µ —Ñ–∞–π–ª—ã |
| 85-95% | üü† –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ | –û—á–∏—Å—Ç–∏—Ç—å –ª–æ–≥–∏ –∏ backups |
| > 95% | üî¥ –ö–†–ò–¢–ò–ß–ù–û | –≠–∫—Å—Ç—Ä–µ–Ω–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞! |

### –ö–æ–º–∞–Ω–¥—ã –ø—Ä–æ–≤–µ—Ä–∫–∏:

```bash
# –¢–µ–∫—É—â–µ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
df -h / | awk 'NR==2 {print $5}' | sed 's/%//'

# –ê–ª–µ—Ä—Ç –µ—Å–ª–∏ > 85%
USAGE=$(df -h / | awk 'NR==2 {print $5}' | sed 's/%//')
if [ $USAGE -gt 85 ]; then
    echo "‚ö†Ô∏è –í–ù–ò–ú–ê–ù–ò–ï! –î–∏—Å–∫ –∑–∞–ø–æ–ª–Ω–µ–Ω –Ω–∞ $USAGE%"
    echo "–ó–∞–ø—É—Å—Ç–∏—Ç–µ: sudo logrotate -f /etc/logrotate.d/asterisk"
fi
```

---

## üìù –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π

### 15.10.2025 - v1.1:
- ‚úÖ **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ —Ä–æ—Ç–∞—Ü–∏—è –ª–æ–≥–æ–≤** - –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–æ 10GB (83% ‚Üí 47%)
- ‚úÖ **–£–º–µ–Ω—å—à–µ–Ω —É—Ä–æ–≤–µ–Ω—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è** - —Ä–æ—Å—Ç –ª–æ–≥–æ–≤ –∑–∞–º–µ–¥–ª–µ–Ω –≤ 10 —Ä–∞–∑
- ‚úÖ **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Metrotech** - –¥–æ–±–∞–≤–ª–µ–Ω copytruncate
- ‚úÖ **–°–æ–∑–¥–∞–Ω –ø–æ–ª–Ω—ã–π backup** –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π –≤ `backup_configs/`
- ‚úÖ **–î–æ–±–∞–≤–ª–µ–Ω CHANGELOG.md** —Å –¥–µ—Ç–∞–ª—å–Ω–æ–π –∏—Å—Ç–æ—Ä–∏–µ–π

### 15.10.2025 - v1.0:
- ‚úÖ –û–±–Ω–∞—Ä—É–∂–µ–Ω–∞ –ø—Ä–æ–±–ª–µ–º–∞ —Å Asterisk –ª–æ–≥–∞–º–∏ (4.6GB)
- ‚úÖ –°–æ–∑–¥–∞–Ω–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è logrotate –¥–ª—è Asterisk
- ‚úÖ –°–æ–∑–¥–∞–Ω —Å–∫—Ä–∏–ø—Ç –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ `disk_check.sh`
- ‚úÖ –ù–∞—Å—Ç—Ä–æ–µ–Ω—ã —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –æ—á–∏—Å—Ç–∫–µ

> üìÑ –ü–æ–ª–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ `CHANGELOG.md`

---

## üîó –°–≤—è–∑–∞–Ω–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã

- **–ì–∞–π–¥ –ø–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—é**: `docs/LOGGING_GUIDE.md`
- **Systemd —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**: `docs/Systemd/SYSTEMD_–£–ü–†–ê–í–õ–ï–ù–ò–ï_–í–°–ï–•_–°–ï–†–í–ò–°–û–í.md`
- **–û—Å–Ω–æ–≤–Ω–æ–π README**: `asterisk-vox-bot/README.md`

---

## üí° –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã (—à–ø–∞—Ä–≥–∞–ª–∫–∞)

```bash
# === –ü–†–û–í–ï–†–ö–ê ===
df -h /                                    # –û–±—â–µ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –¥–∏—Å–∫–∞
du -sh /root/Asterisk_bot/*                # –†–∞–∑–º–µ—Ä—ã –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π –ø—Ä–æ–µ–∫—Ç–∞
ls -lh /var/log/asterisk/messages.log      # –†–∞–∑–º–µ—Ä –≥–ª–∞–≤–Ω–æ–≥–æ –ª–æ–≥–∞ Asterisk
./disk_check.sh --compare                  # –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–∫—Ä–∏–ø—Ç –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

# === –û–ß–ò–°–¢–ö–ê ===
sudo logrotate -f /etc/logrotate.d/asterisk           # –†–æ—Ç–∞—Ü–∏—è –ª–æ–≥–æ–≤ Asterisk
find /var/spool/asterisk/recording/ -mtime +30 -delete  # –£–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ä—ã–µ –∑–∞–ø–∏—Å–∏
find /var/lib/asterisk/sounds/ -name "stream_*.wav" -mtime +7 -delete  # –£–¥–∞–ª–∏—Ç—å TTS

# === –≠–ö–°–¢–†–ï–ù–ù–ê–Ø –ü–û–ú–û–©–¨ (–¥–∏—Å–∫ > 95%) ===
sudo truncate -s 0 /var/log/asterisk/messages.log     # –û—á–∏—Å—Ç–∏—Ç—å Asterisk –ª–æ–≥
sudo asterisk -rx 'logger reload'                     # –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å –ª–æ–≥–≥–µ—Ä
rm -rf /var/spool/asterisk/recording/*.wav            # –£–¥–∞–ª–∏—Ç—å –≤—Å–µ –∑–∞–ø–∏—Å–∏
```

---

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è**: 15.10.2025  
**–í–µ—Ä—Å–∏—è**: 1.0  
**–ê–≤—Ç–æ—Ä**: –°–∏—Å—Ç–µ–º–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞ "–ú–µ—Ç—Ä–æ—Ç—ç—Å—Ç"

> üíæ **–°–ª–µ–¥–∏—Ç–µ –∑–∞ –¥–∏—Å–∫–æ–≤—ã–º –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ–º!** –ó–∞–ø—É—Å–∫–∞–π—Ç–µ `disk_check.sh` —Ä–∞–∑ –≤ –Ω–µ–¥–µ–ª—é.

